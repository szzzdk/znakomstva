{"version":3,"file":"i18n-s.esm.js","sources":["../lib/util.js","../index.js"],"sourcesContent":["export function regExpEscape(s){\n  return String(s).replace(/[\\\\^$*+?.()|[\\]{}]/g, '\\\\$&');\n};\n","import { regExpEscape } from './lib/util';\n\nexport default class I18n {\n\n  constructor(opts = {}) {\n    let { \n      locale = 'zh-CN', \n      i18nData = {},\n      log = (process.env.NODE_ENV !== 'production'),\n    } = opts;\n\n    // data\n    this._locale = locale;\n    this._i18nData = i18nData;\n    this._log = log;\n  }\n\n  // log\n  log(msg) {\n    // no log\n    if (!this._log) return;\n    // log msg\n    if (typeof this._log === 'function') {\n      this._log(msg);\n    } else if (console && console.log) {\n      console.log(msg);\n    }\n  }\n\n  // set locale data of one locale\n  setLocaleData(locale, data={}) {\n    this._i18nData[locale] = data;\n  }\n\n  // get locale data\n  getLocaleData(lc) {\n    let locale = lc || this.getLocale();\n    return this._i18nData[locale] || {};\n  }\n\n  // set the current locale\n  setLocale(locale) {\n    this._locale = locale;\n  }\n\n  // get the current locale\n  getLocale() {\n    return this._locale;\n  }\n\n  // translate keys\n  translate(key, vars={}) {\n    let locale = this._locale;\n    let data = this._i18nData[locale] || {};\n    let val = data[key];\n    let arr = key.split('.', 2);\n\n    if (!val && arr.length > 1) {\n      val = this.findDotTranslate(arr[1], data[arr[0]]);\n    }\n\n    if (!val) {\n      this.log(`Translate lost: [${locale}] => [${key}]`);\n      return val;\n    }\n\n    return this.formatString(val, vars);\n  }\n\n  __(...args) {\n    return this.translate(...args);\n  }\n\n  findDotTranslate(key, data) {\n    if (typeof data !== 'object') return null;\n\n    let val = data[key];\n    let arr = key.split('.', 2);\n\n    if (val) return val;\n\n    if (arr.length > 1) {\n      val = this.findDotTranslate(arr[1], data[arr[0]]);\n    }\n\n    return val;\n  }\n\n  // format string\n  formatString(string, vars={}) {\n    Object.keys(vars).forEach((key) => {\n      let re = new RegExp('\\\\$\\\\{' + regExpEscape(key) + '\\\\}', 'g');\n      string = string.replace(re, vars[key]);\n    });\n    return string;\n  }\n}\n"],"names":["regExpEscape","s","String","replace","I18n","opts","locale","i18nData","log","process","env","NODE_ENV","_locale","_i18nData","_log","msg","console","data","lc","getLocale","key","vars","val","arr","split","length","findDotTranslate","formatString","translate","string","Object","keys","forEach","re","RegExp"],"mappings":"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"}